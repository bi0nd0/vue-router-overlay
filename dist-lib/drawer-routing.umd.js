(function(d,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("vue-router")):typeof define=="function"&&define.amd?define(["exports","vue","vue-router"],e):(d=typeof globalThis<"u"?globalThis:d||self,e(d.DrawerRoutingPlugin={},d.Vue,d.VueRouter))})(this,function(d,e,f){"use strict";const h={__name:"MainRouterView",setup(n){const l=f.useRouter(),o=()=>t.baseRoute||l.currentRoute.value,a=e.computed(()=>{if(t.isOpen&&t.baseRoute){const u=t.baseRoute,r=[...u.matched].filter(c=>{var s;return((s=c.meta)==null?void 0:s.overlay)!==!0});return{...u,matched:r}}return o()}),i=e.computed(()=>a.value.fullPath);return(u,r)=>(e.openBlock(),e.createBlock(e.unref(f.RouterView),{key:i.value,route:a.value},null,8,["route"]))}},m={__name:"OverlayRouterView",props:{filterMatchedRoutes:{type:Function,default:n=>n.filter(l=>{var o;return((o=l.meta)==null?void 0:o.overlay)===!0})}},setup(n){const l=f.useRouter(),o=e.computed(()=>t.isOpen),a=n,i=e.computed(()=>{if(!t.overlayRoute)return null;const c=a.filterMatchedRoutes([...t.overlayRoute.matched]);return{...t.overlayRoute,matched:c}});function u(c){c.key==="Escape"&&o.value&&r()}const r=()=>{console.log("closing drawer"),t.baseRoute&&l.push(t.baseRoute)};return e.onMounted(()=>{window.addEventListener("keydown",u)}),e.onBeforeUnmount(()=>{window.removeEventListener("keydown",u)}),(c,s)=>(e.openBlock(),e.createBlock(e.unref(f.RouterView),{route:i.value},{default:e.withCtx(p=>[e.renderSlot(c.$slots,"default",e.normalizeProps(e.guardReactiveProps({...p,isOpen:o.value,closeOverlay:r})),()=>[i.value?(e.openBlock(),e.createBlock(e.resolveDynamicComponent(p.Component),{key:0,"close-overlay":r,"is-open":o.value},null,8,["is-open"])):e.createCommentVNode("",!0)])]),_:3},8,["route"]))}},R=(n,l)=>{const o=n.__vccOpts||n;for(const[a,i]of l)o[a]=i;return o},_={key:0,class:"drawer-container"},w={class:"drawer-header"},O={class:"drawer-content"},k=R({__name:"Drawer",props:{width:{type:String,default:"400px"},position:{type:String,default:"right"},isOpen:{type:Boolean,default:!1}},emits:["hide"],setup(n,{emit:l}){const o=n,{isOpen:a}=e.toRefs(o),i=l;function u(){setTimeout(()=>{console.log("hiding"),i("hide")},0)}const r=e.computed(()=>({width:o.width,[o.position]:a.value?"0":`-${o.width}`}));return(c,s)=>{var p;return e.unref(a)?(e.openBlock(),e.createElementBlock("div",_,[e.createElementVNode("div",{class:"drawer-backdrop",onClick:u}),e.createElementVNode("div",{class:"drawer",style:e.normalizeStyle(r.value)},[e.createElementVNode("div",w,[e.createElementVNode("div",null,[e.createElementVNode("span",null,e.toDisplayString(((p=e.unref(t).overlayRoute.meta)==null?void 0:p.title)??""),1)]),e.createElementVNode("button",{class:"drawer-close",onClick:u},"Ã—")]),e.createElementVNode("div",O,[s[0]||(s[0]=e.createElementVNode("div",null,"asdasdsa",-1)),e.renderSlot(c.$slots,"default",{},void 0,!0)])],4)])):e.createCommentVNode("",!0)}}},[["__scopeId","data-v-ddc8c3b0"]]),V={__name:"DrawerRouterView",setup(n){return(l,o)=>(e.openBlock(),e.createBlock(m,null,{default:e.withCtx(({isOpen:a,Component:i,closeOverlay:u})=>[e.createVNode(k,{"is-open":a,onHide:u},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(i)))]),_:2},1032,["is-open","onHide"])]),_:1}))}},t=e.reactive({isOpen:!1,baseRoute:null,overlayRoute:null});function g(){const n=new Set;let l=null;return{install(o,{router:a}){o.component("MainRouterView",h),o.component("OverlayRouterView",m),o.component("DrawerRouterView",V);const i=(r,c="")=>{r.forEach(s=>{var y;const p=c+(s.path.startsWith("/")?s.path:`/${s.path}`);(y=s.meta)!=null&&y.overlay&&n.add(s.name||p),s.children&&i(s.children,p)})};i(a.getRoutes());const u=r=>r.name===void 0&&r.matched.length===0;a.beforeEach((r,c,s)=>{if(b(r,n)){if(u(c)){l=r.fullPath,s({path:"/",replace:!0});return}t.isOpen||(t.baseRoute=e.markRaw(c),t.isOpen=!0),t.overlayRoute=e.markRaw(r),s()}else t.isOpen?t.isOpen=!1:(t.overlayRoute=null,t.baseRoute=null),s()}),a.afterEach(()=>{l&&(a.push(l),l=null)}),o.provide("overlayRouter",{state:t,isOverlayRoute:r=>n.has(r),isOverlayActive:()=>t.isOpen})}}}function b(n,l){var o;return!!((o=n.meta)!=null&&o.overlay||n.name&&l.has(n.name)||n.matched&&n.matched.some(a=>{var i;return(i=a.meta)==null?void 0:i.overlay}))}function v(){const n=f.useRouter();return{overlayState:t,isOverlayOpen:()=>t.isOpen,closeOverlay(){t.baseRoute&&n.push(t.baseRoute)}}}d.default=g,d.useOverlayRouter=v,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
