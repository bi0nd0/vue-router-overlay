(function(d,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("vue-router")):typeof define=="function"&&define.amd?define(["exports","vue","vue-router"],e):(d=typeof globalThis<"u"?globalThis:d||self,e(d.DrawerRoutingPlugin={},d.Vue,d.VueRouter))})(this,function(d,e,f){"use strict";const h={__name:"MainRouterView",setup(n){const s=f.useRouter(),o=()=>t.baseRoute||s.currentRoute.value,r=e.computed(()=>{if(t.isOpen&&t.baseRoute){const u=t.baseRoute,a=[...u.matched].filter(c=>{var l;return((l=c.meta)==null?void 0:l.overlay)!==!0});return{...u,matched:a}}return o()}),i=e.computed(()=>r.value.fullPath);return(u,a)=>(e.openBlock(),e.createBlock(e.unref(f.RouterView),{key:i.value,route:r.value},null,8,["route"]))}},m={__name:"OverlayRouterView",props:{filterMatchedRoutes:{type:Function,default:n=>n.filter(s=>{var o;return((o=s.meta)==null?void 0:o.overlay)===!0})}},setup(n){const s=f.useRouter(),o=e.computed(()=>t.isOpen),r=n,i=e.computed(()=>{if(!t.overlayRoute)return null;const c=r.filterMatchedRoutes([...t.overlayRoute.matched]);return{...t.overlayRoute,matched:c}});function u(c){c.key==="Escape"&&o.value&&a()}const a=()=>{console.log("closing drawer"),t.baseRoute&&s.push(t.baseRoute)};return e.onMounted(()=>{window.addEventListener("keydown",u)}),e.onBeforeUnmount(()=>{window.removeEventListener("keydown",u)}),(c,l)=>i.value?(e.openBlock(),e.createBlock(e.unref(f.RouterView),{key:0,route:i.value},{default:e.withCtx(p=>[e.renderSlot(c.$slots,"default",e.normalizeProps(e.guardReactiveProps({...p,isOpen:o.value,closeOverlay:a})),()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(p.Component),{"close-overlay":a,"is-open":o.value},null,8,["is-open"]))])]),_:3},8,["route"])):e.createCommentVNode("",!0)}},R=(n,s)=>{const o=n.__vccOpts||n;for(const[r,i]of s)o[r]=i;return o},_={key:0,class:"drawer-container"},w={class:"drawer-header"},O={class:"drawer-content"},k=R({__name:"Drawer",props:{width:{type:String,default:"400px"},position:{type:String,default:"right"},isOpen:{type:Boolean,default:!1}},emits:["hide"],setup(n,{emit:s}){const o=n,{isOpen:r}=e.toRefs(o),i=s;function u(){setTimeout(()=>{console.log("hiding"),i("hide")},0)}const a=e.computed(()=>({width:o.width,[o.position]:r.value?"0":`-${o.width}`}));return(c,l)=>{var p;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createTextVNode(e.toDisplayString(e.unref(r)?"yes":"no")+" ",1),e.unref(r)?(e.openBlock(),e.createElementBlock("div",_,[e.createElementVNode("div",{class:"drawer-backdrop",onClick:u}),e.createElementVNode("div",{class:"drawer",style:e.normalizeStyle(a.value)},[e.createElementVNode("div",w,[e.createElementVNode("div",null,[e.createElementVNode("span",null,e.toDisplayString(((p=e.unref(t).overlayRoute.meta)==null?void 0:p.title)??""),1)]),e.createElementVNode("button",{class:"drawer-close",onClick:u},"Ã—")]),e.createElementVNode("div",O,[l[0]||(l[0]=e.createElementVNode("div",null,"asdasdsa",-1)),e.renderSlot(c.$slots,"default",{},void 0,!0)])],4)])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-3aad5920"]]),V={__name:"DrawerRouterView",setup(n){return(s,o)=>(e.openBlock(),e.createBlock(m,null,{default:e.withCtx(({isOpen:r,Component:i,closeOverlay:u})=>[e.createVNode(k,{"is-open":r,onHide:u},{default:e.withCtx(()=>[(e.openBlock(),e.createBlock(e.resolveDynamicComponent(i)))]),_:2},1032,["is-open","onHide"])]),_:1}))}},t=e.reactive({isOpen:!1,baseRoute:null,overlayRoute:null});function g(){const n=new Set;let s=null;return{install(o,{router:r}){o.component("MainRouterView",h),o.component("OverlayRouterView",m),o.component("DrawerRouterView",V);const i=(a,c="")=>{a.forEach(l=>{var y;const p=c+(l.path.startsWith("/")?l.path:`/${l.path}`);(y=l.meta)!=null&&y.overlay&&n.add(l.name||p),l.children&&i(l.children,p)})};i(r.getRoutes());const u=a=>a.name===void 0&&a.matched.length===0;r.beforeEach((a,c,l)=>{if(B(a,n)){if(u(c)){s=a.fullPath,l({path:"/",replace:!0});return}t.isOpen||(t.baseRoute=e.markRaw(c),t.isOpen=!0),t.overlayRoute=e.markRaw(a),l()}else t.isOpen?t.isOpen=!1:(t.overlayRoute=null,t.baseRoute=null),l()}),r.afterEach(()=>{s&&(r.push(s),s=null)}),o.provide("overlayRouter",{state:t,isOverlayRoute:a=>n.has(a),isOverlayActive:()=>t.isOpen})}}}function B(n,s){var o;return!!((o=n.meta)!=null&&o.overlay||n.name&&s.has(n.name)||n.matched&&n.matched.some(r=>{var i;return(i=r.meta)==null?void 0:i.overlay}))}function E(){const n=f.useRouter();return{overlayState:t,isOverlayOpen:()=>t.isOpen,closeOverlay(){t.baseRoute&&n.push(t.baseRoute)}}}d.default=g,d.useOverlayRouter=E,Object.defineProperties(d,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
